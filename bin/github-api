#!/usr/bin/env bash

TOKEN="GITHUB_TOKEN"

usage() {
	echo >&2 "Usage: $0 [-t <ENV_VAR_GITHUB_TOKEN_NAME>] api/endpoint/path"
}

while getopts t: opt; do
	case "$opt" in
		t) TOKEN="$OPTARG"
		;;
		*) usage && exit 1
		;;
	esac
done
shift $((OPTIND-1))

echo "TOKEN=$TOKEN"

[[ ! -z ${!TOKEN} ]] || { echo "empty token" && exit 1; }

curl https://api.github.com/"$1" \
	--silent \
	-H "Authorization: token ${!TOKEN}"

